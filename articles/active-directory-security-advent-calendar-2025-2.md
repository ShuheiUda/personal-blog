---
title: "Active Directory 環境を縮小していくには"
emoji: "🛡️"
type: "tech"
topics:
  - "identity"
  - "activedirectory"
  - "microsoft"
  - "entraid"
published: true
published_at: "2025-12-15 23:59"
publication_name: "microsoft"
---

本投稿は [Active Directory Security Advent Calendar 2025](https://qiita.com/advent-calendar/2025/active-directory-security) 15 日目として公開しています。
AD のセキュリティ対策を考える上で有用な投稿が他にも多数公開されていますので、是非あわせてご覧ください。

## はじめに

Active Directory に限らず、「ID」は常に攻撃者にとって魅力的な存在です。なぜなら、管理者権限を持つ特権アカウントさえ奪取できてしまえば、その正規のアカウントを使ってあらゆる操作ができてしまうからです。

でも、数多ある ID 基盤 (IdP) の中で何故 Active Directory ばかりが負の遺産として悪者のようにやり玉に挙げられるのでしょうか。

個人的な主観ですが、主に以下のような点が理由なのではないかと思っています。

- シェアゆえのインシデント件数の多さ
- 侵害された際の影響範囲の広さ
- ID とパスワードのみに頼った認証である点
- 枯れた製品ゆえに様々な攻撃手法が普及してしまっている点
- 旧来からのオンプレミス環境を維持・管理できるエンジニアが減少している点

他にも様々な理由があるでしょうが、攻撃者にとって管理や監視が不十分な AD ほど魅力的なものはありません。したがって、今すぐ AD 環境を完全になくすのは難しいとしても、以下のいずれかもしくは両方の選択肢を考える必要があります。

- 既存の AD 環境を安全に使い続けるために Tier モデルで堅牢化したり、監視体制を強化する
- AD 環境を徐々に縮退して、Entra ID 等のクラウド型の IdP (IDaaS) に切り替える

本投稿では、後者の縮退を進める上で考えなければならないことをいくつかピックアップして取り上げていこうと思います。

## AD から Entra ID に乗り換えると何が変わるのか

AD 環境を縮小ないし廃止して、Entra ID を主たる IdP にすることで何が変わるのでしょうか。そして、単に Entra ID に乗り換えるだけでセキュアになったと言い切れるのでしょうか。

Entra ID に切り替えるメリットとしては、以下のような機能が利用できる点があげられます。

- 多要素認証 (MFA) の導入
- Just-In-Time の特権アクセス (PIM)
- 条件付きアクセスによる細かな制御
- リスク検出による不審な振る舞いの検知・ブロック

ただ、デフォルトで有効になっている機能ばかりでもありません。ユーザーが正しく設定や運用を行うことが必要不可欠なのは AD でも Entra ID でも同様です。

### (補足) ライセンスのお話

上記であげた機能の中には、Entra ID の有償ライセンスが必要なものも多く含まれます。

以下のページに Free / P1 / P2 等のライセンスに応じた利用できる機能の一覧がまとまっていますので、あわせてご参照ください。

[Microsoft Entra ライセンス](https://learn.microsoft.com/ja-jp/entra/fundamentals/licensing)

なお、エンタープライズのお客様の場合、Microsoft 365 E3 / E5 や Enterprise Mobility + Security E3 / E5 等のライセンスをご利用の場合が多いかと思います。こうした Suite 製品には Entra ID P1 ないし P2 ライセンスが包含されていますので、有償ライセンスをお持ちの場合はぜひ漏れなく使い倒していただきたいなと思います。

[ライセンスごとの機能比較表](https://cdn-dynmedia-1.microsoft.com/is/content/microsoftcorp/microsoft/bade/documents/products-and-services/en-us/education/Modern-Work-Plan-Comparison-Enterprise.pdf)

![ライセンスごとの機能比較表](/images/active-directory-security-advent-calendar-2025-2/1.png)

## AD 縮退 / Entra 移行の 5 つのフェーズ

既に [Day 5](https://blog.o365mvp.com/2025/12/06/blueprint-of-future-ad/) の投稿でも触れていただいていますが、[こちらのドキュメント](https://learn.microsoft.com/ja-jp/entra/architecture/road-to-the-cloud-posture) に AD から Entra ID へ移行する際の流れがまとまっています。

![Entra ID への移行フェーズ](/images/active-directory-security-advent-calendar-2025-2/2.png)

要点だけまとめると、移行に際して以下の 3 つの要素に分けて、

- アプリケーション
- デバイス
- ユーザーおよびグループ

それらの管理主体を AD から Entra ID へ、5 つのステップで移行する流れが解説されています。

1. クラウド接続
1. ハイブリッド
1. クラウド ファースト
1. AD 最小化
1. 100% クラウド


### 第一段階: クラウド接続

既に第一段階は通過し終えた方ばかりかと思いますが、ざっくりいうと Entra ID Connect を使ってユーザーやグループの情報を Entra に同期しはじめた状態です。

一昔前を振り返ると、オンプレミスの AD のみで ID 管理されていた時代がありました。そこから Microsoft 365 (Office 365) や Azure 等のクラウド サービスの登場に伴って、Entra ID (当時は Azure AD) のテナントを作る必要が生じ、Entra を使い始めたという方も多かったかと思います。そして、既存の AD ユーザーで SSO を実現するために Entra ID Connect や前身の Azure AD Sync を使って AD 上のユーザーやグループ情報を Entra に同期しはじめたのが、今から大体 10 年くらい前の 2010 年代半ばだったかなと思います。


### 第二段階: ハイブリッド

続いて、端末を Hybrid Join の構成へ切り替えたり、他の SaaS 製品も Entra ID で認証するようになった状態が二段階目のハイブリッド フェーズです。Microsoft 製品に限らず各社の SaaS が Entra ID と統合されるようになった一方で、旧来からのレガシー アプリケーションは AD で認証し続けているような状態です。(この辺りで止まっているパターンもまだまだ多いのではないかと思っています。)

### 第三段階: クラウド ファースト

第三段階のクラウド ファースト フェーズでは、デバイスが Entra Join や Intune での管理へ切り替えっていることが前提となります。そのため、第二段階から第三段階への移行は PC の更改タイミングとあわせて行われる場合が多く、全社員の端末が一通りリプレースされて Entra Join へと切り替わるまでには数年単位で時間がかかる事もあります。また、このタイミングでデバイスが AD に参加しなくなるため、業務アプリケーションを棚卸しして、Entra で認証できるようにモダナイズを進めたり、不要なものを廃止する等の事前準備も並行して必要になります。

### 第四段階: AD 最小化

このフェーズまでくるとデバイスが Entra Join なのはもちろん、ユーザーやグループの作成・管理、業務アプリケーションの認証まで原則 Entra 側に寄せられた状態になります。一部の例外的なシナリオ (移行が難しいアプリケーションなど) のみが AD を引き続き利用しますが、それ以外では AD を利用しなくなり、仮に AD が侵害されたとしても影響範囲が限定的になることが期待されます。

また、このフェーズにいたる頃には新規ユーザー作成のような管理業務も、AD 上ではなく Entra 側を主軸に行われるようになっているかと思います。元々 AD 上で作成された既存のユーザーやグループについても、現在は Entra 側に SOA (Source of Authority) 変換する機能が出ていますので、こうした機能も活用していただければと思います。

[クラウド ファーストの ID 管理 - ユーザー SOA がパブリック プレビューかつグループ SOA も一般公開に](https://jpazureid.github.io/blog/azure-active-directory-connect/driving-cloud-first-identity-user-soa-is-now-public-preview-and-group-soa-is-gen/)

なお余談ですが、AD の管理者ユーザー (Domain Admins 等) については、Entra ID 側に同期しないようにしてください。AD の特権ユーザーが侵害された際に、クラウド側まで侵害が広がらないようにするために、AD と Entra の管理者ユーザーは別のアカウントを利用することが推奨されています。

### 第五段階: 100% クラウド

最後の第五段階は、ユーザーもデバイスもアプリケーションも AD に依存しなくなり、AD が存在しなくなった状態です。この段階まで達するのは容易ではない認識ですが、IT インフラを新たにゼロから構築するような場合 (新規で設立した会社であったり、特定の業務のためだけに新設される環境など) については、最初から AD を作らず Entra オンリーという場合はあり得るかなと思います。

-----

ということで、非常にざっくりですが AD の縮退や Entra 移行の流れについて紹介しました。

我が家の検証環境もまだまだ移行しきれていない状況なので、引き続き試行錯誤しながら Entra に寄せていければと思います。皆さんの身近な AD 環境も、管理できる人がいるうちに徐々に縮退を検討してみてはいかがでしょうか。
